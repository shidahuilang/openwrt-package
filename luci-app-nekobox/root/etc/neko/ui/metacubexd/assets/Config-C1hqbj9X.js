import{b as X,y as te,u as j,a_ as U,D as Z,d as e,i as t,ac as y,S,t as d,z as C,a$ as le,c as K,A as re,f as W,B as w,F as A,r as J,b0 as _,g as P,b1 as ne,b2 as ae,b3 as se,b4 as ie,b5 as ce,b6 as oe,b7 as ue,b8 as de,b9 as ge,ba as he,bb as ve,bc as fe,bd as O,be as pe,bf as be,bg as me,aZ as $e,l as _e,bh as xe,bi as z,bj as ke,bk as Ce,bl as H,bm as ye,bn as we,bo as Se,bp as L,bq as M,q as R,a0 as V,K as Y,v as ee,j as Ie,br as Ae,bs as De,bt as Pe,bu as Te}from"./index-CvtbhWKk.js";import{D as Fe}from"./DocumentTitle-CAyQkV9I.js";var Ne=d("<input type=checkbox>"),Be=d("<input>"),Ue=d("<select>"),Ee=d('<label><span class="label-text truncate">'),je=d("<option>A"),Le=d("<option>AAAA"),Me=d("<option>MX"),Re=d('<div class="flex flex-col p-4">'),Ve=d('<div class="flex flex-col"><form class="flex gap-2 sm:flex-row"><div class="flex items-center gap-2">'),Qe=d("<div class=py-2>"),qe=d('<div class="grid grid-cols-3 gap-2"><div class=form-control></div><div class=form-control></div><div class=form-control>'),Ge=d('<form class="grid grid-cols-3 gap-2 sm:grid-cols-5">'),Oe=d('<div class="flex flex-col gap-4"><div class="grid grid-cols-3 gap-2"><div class=form-control></div><div class=form-control></div><div class=form-control></div></div><div class="grid grid-cols-2 gap-4 sm:grid-cols-3">'),N=d("<option>"),ze=d("<div class=form-control>"),He=d('<div class="flex flex-col gap-2"><div class="flex flex-col"></div><div class="flex flex-col">'),Xe=d('<div class="grid grid-cols-1 gap-4 sm:grid-cols-2"><div class="flex flex-col gap-2"><div class="flex flex-col items-center"></div><div class="flex flex-col"></div><div class="flex flex-col"><div class="py-2 text-center text-lg font-semibold">&nbsp;</div></div></div><div class="flex flex-col gap-2"><div class="flex flex-col items-center">'),Ze=d('<span class="absolute -right-1 -top-1 flex h-3 w-3"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-info opacity-75"></span><span class="inline-flex h-3 w-3 rounded-full bg-info">'),Ke=d('<div class="grid grid-cols-2 gap-4"><div class=relative><kbd class="kbd w-full"></kbd></div><div class=relative><kbd class="kbd w-full">'),We=d('<div class="mx-auto flex max-w-screen-md flex-col gap-4">');const E=s=>{const[c,l]=L(s,["class"]);return(()=>{var a=Ne();return M(a,R({get class(){return V("toggle",c.class)}},l),!1,!1),a})()},B=s=>{const[c,l]=L(s,["class"]);return(()=>{var a=Be();return M(a,R({get class(){return V("input input-bordered min-w-0",c.class)}},l),!1,!1),a})()},T=s=>{const[c,l]=L(s,["class"]);return(()=>{var a=Ue();return M(a,R({get class(){return V("select select-bordered",c.class)}},l),!1,!0),t(a,()=>Y(()=>l.children)()),a})()},I=s=>{const[c,l]=L(s,["class"]);return(()=>{var a=Ee(),f=a.firstChild;return M(a,R({get class(){return V("label",c.class)}},l),!1,!0),t(f,()=>Y(()=>l.children)()),a})()},Je=C.object({name:C.string(),type:C.string()}),Ye=()=>{const[s]=j(),c=le(),{form:l,isSubmitting:a}=K({extend:ee({schema:Je}),onSubmit:n=>c.get("dns/query",{searchParams:{name:n.name,type:n.type}}).json().then(({Answer:i})=>p((i==null?void 0:i.map(({data:o})=>o))||[])).catch(i=>Ie.error(i.message))}),[f,p]=re([]);return(()=>{var n=Ve(),i=n.firstChild,o=i.firstChild;return W(l,i,()=>l),t(i,e(B,{type:"search",name:"name",class:"flex-1",placeholder:"google.com",onInput:m=>{m.target.value||p([])}}),o),t(o,e(T,{name:"type",get children(){return[je(),Le(),Me()]}}),null),t(o,e(w,{type:"submit",class:"btn-primary",get loading(){return a()},get children(){return s("dnsQuery")}}),null),t(n,e(S,{get when(){return f().length>0},get children(){var m=Re();return t(m,e(A,{get each(){return f()},children:r=>(()=>{var b=Qe();return t(b,r),b})()})),m}}),null),n})()},et=C.object({port:C.number(),"socks-port":C.number(),"redir-port":C.number(),"tproxy-port":C.number(),"mixed-port":C.number()}),tt=({isSingBox:s,fetchBackendVersion:c})=>{const[l]=j(),a=[{label:()=>l("port",{name:"Mixed"}),key:"mixed-port",onChange:r=>void _("mixed-port",Number(r.target.value),o)},{label:()=>l("port",{name:"HTTP"}),key:"port",onChange:r=>void _("port",Number(r.target.value),o)},{label:()=>l("port",{name:"Socks"}),key:"socks-port",onChange:r=>void _("socks-port",Number(r.target.value),o)},{label:()=>l("port",{name:"Redir"}),key:"redir-port",onChange:r=>void _("redir-port",Number(r.target.value),o)},{label:()=>l("port",{name:"TProxy"}),key:"tproxy-port",onChange:r=>void _("tproxy-port",Number(r.target.value),o)}],{form:f,setInitialValues:p,reset:n}=K({extend:ee({schema:et})}),[i,{refetch:o}]=U(Ae);J(()=>{const r=i();r&&(p(r),n())});const m=Z(()=>{var r;return((r=i())==null?void 0:r.modes)||["rule","direct","global"]});return(()=>{var r=Oe(),b=r.firstChild,D=b.firstChild,g=D.nextSibling,$=g.nextSibling,F=b.nextSibling;return t(D,e(I,{for:"enable-allow-lan",get children(){return l("allowLan")}}),null),t(D,e(E,{id:"enable-allow-lan",get checked(){var u;return(u=i())==null?void 0:u["allow-lan"]},onChange:u=>void _("allow-lan",u.target.checked,o)}),null),t(g,e(I,{for:"mode",get children(){return l("runningMode")}}),null),t(g,e(T,{id:"mode",onChange:u=>void _("mode",u.target.value,o),get children(){return e(A,{get each(){return m()},children:u=>(()=>{var h=N();return h.value=u,t(h,()=>l(u)),P(()=>{var x;return h.selected=u===((x=i())==null?void 0:x.mode)}),h})()})}}),null),t($,e(I,{for:"interface-name",get children(){return l("outboundInterfaceName")}}),null),t($,e(B,{id:"interface-name",get value(){var u;return(u=i())==null?void 0:u["interface-name"]},onChange:u=>void _("interface-name",u.target.value,o)}),null),t(r,e(S,{get when(){return!s()},get children(){return[(()=>{var u=qe(),h=u.firstChild,x=h.nextSibling,Q=x.nextSibling;return t(h,e(I,{for:"enable-tun-device",get children(){return l("enableTunDevice")}}),null),t(h,e(E,{id:"enable-tun-device",get checked(){var v,k;return(k=(v=i())==null?void 0:v.tun)==null?void 0:k.enable},onChange:v=>void _("tun",{enable:v.target.checked},o)}),null),t(x,e(I,{for:"tun-ip-stack",get children(){return l("tunModeStack")}}),null),t(x,e(T,{id:"tun-ip-stack",onChange:v=>void _("tun",{stack:v.target.value},o),get children(){return e(A,{each:["Mixed","gVisor","System","LWIP"],children:v=>(()=>{var k=N();return k.value=v,t(k,v),P(()=>{var q,G;return k.selected=((G=(q=i())==null?void 0:q.tun)==null?void 0:G.stack)===v}),k})()})}}),null),t(Q,e(I,{for:"device-name",get children(){return l("tunDeviceName")}}),null),t(Q,e(B,{id:"device-name",get value(){var v,k;return(k=(v=i())==null?void 0:v.tun)==null?void 0:k.device},onChange:v=>void _("tun",{device:v.target.value},o)}),null),u})(),(()=>{var u=Ge();return W(f,u,()=>f),t(u,e(A,{each:a,children:h=>(()=>{var x=ze();return t(x,e(I,{get for(){return h.key},get children(){return h.label()}}),null),t(x,e(B,{get id(){return h.key},get name(){return h.key},type:"number",get placeholder(){return h.label()},get onChange(){return h.onChange}}),null),x})()})),u})()]}}),F),t(F,e(w,{class:"btn-primary",get loading(){return ne()},onClick:ae,get children(){return l("reloadConfig")}}),null),t(F,e(w,{class:"btn-accent",get loading(){return se()},onClick:ie,get children(){return l("flushFakeIP")}}),null),t(F,e(w,{class:"btn-warning",get loading(){return ce()},onClick:oe,get children(){return l("restartCore")}}),null),t(F,e(S,{get when(){return!s()},get children(){return[e(w,{class:"btn-secondary",get loading(){return ue()},onClick:de,get children(){return l("updateGEODatabases")}}),e(w,{class:"btn-info",get loading(){return ge()},onClick:he,get children(){return l("upgradeUI")}}),e(w,{class:"btn-error",get loading(){return ve()},onClick:async()=>{await fe(),await c()},get children(){return l("upgradeCore")}})]}}),null),r})()},lt=()=>{const[s]=j(),c=X(),l=[{label:()=>s("en"),value:O.EN},{label:()=>s("zh"),value:O.ZH}];return(()=>{var a=Xe(),f=a.firstChild,p=f.firstChild,n=p.nextSibling,i=n.nextSibling;i.firstChild;var o=f.nextSibling,m=o.firstChild;return t(p,e(y,{get children(){return s("useTwemoji")}}),null),t(p,e(E,{get checked(){return pe()},onChange:r=>be(r.target.checked)}),null),t(n,e(y,{get children(){return s("switchLanguage")}}),null),t(n,e(T,{onChange:r=>me(r.target.value),get children(){return e(A,{each:l,children:r=>(()=>{var b=N();return t(b,()=>r.label()),P(()=>b.selected=$e()===r.value),P(()=>b.value=r.value),b})()})}}),null),t(i,e(w,{class:"btn-info",onClick:()=>{_e(""),c(xe.Setup)},get children(){return s("switchEndpoint")}}),null),t(m,e(y,{get children(){return s("autoSwitchTheme")}}),null),t(m,e(E,{get checked(){return z()},onChange:r=>ke(r.target.checked)}),null),t(o,e(S,{get when(){return z()},get children(){var r=He(),b=r.firstChild,D=b.nextSibling;return t(b,e(y,{get children(){return s("favDayTheme")}}),null),t(b,e(T,{onChange:g=>Ce(g.target.value),get children(){return e(A,{each:H,children:g=>(()=>{var $=N();return $.value=g,t($,g),P(()=>$.selected=ye()===g),$})()})}}),null),t(D,e(y,{get children(){return s("favNightTheme")}}),null),t(D,e(T,{onChange:g=>we(g.target.value),get children(){return e(A,{each:H,children:g=>(()=>{var $=N();return $.value=g,t($,g),P(()=>$.selected=Se()===g),$})()})}}),null),r}}),null),a})()},rt=({frontendVersion:s,backendVersion:c})=>{const[l]=U(()=>De(s)),[a,{refetch:f}]=U(()=>Pe(c()));J(()=>{f()},c());const p=()=>Ze();return(()=>{var n=Ke(),i=n.firstChild,o=i.firstChild,m=i.nextSibling,r=m.firstChild;return t(i,e(S,{get when(){return l()},get children(){return e(p,{})}}),o),t(o,()=>"1.168.0"),t(m,e(S,{get when(){return a()},get children(){return e(p,{})}}),r),t(r,c),n})()},st=()=>{const s=X();if(!te())return s("/setup",{replace:!0}),null;const[c]=j(),l="v1.168.0",[a,{refetch:f}]=U(Te,{initialValue:""}),p=Z(()=>{var n;return((n=a())==null?void 0:n.includes("sing-box"))||!1});return[e(Fe,{get children(){return c("config")}}),(()=>{var n=We();return t(n,e(S,{get when(){return!p()},get children(){return[e(y,{withDivider:!0,get children(){return c("dnsQuery")}}),e(Ye,{})]}}),null),t(n,e(y,{withDivider:!0,get children(){return c("coreConfig")}}),null),t(n,e(tt,{isSingBox:p,fetchBackendVersion:()=>f()}),null),t(n,e(y,{withDivider:!0,get children(){return c("xdConfig")}}),null),t(n,e(lt,{}),null),t(n,e(y,{withDivider:!0,get children(){return c("version")}}),null),t(n,e(S,{get when(){return!a.loading},get children(){return e(rt,{frontendVersion:l,backendVersion:a})}}),null),n})()]};export{st as default};
