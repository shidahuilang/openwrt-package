import{N as Ee,u as ee,d as e,ap as De,i as t,ac as D,aq as Ie,ar as Me,D as p,as as ke,at as Oe,F as H,au as Ae,av as Be,aw as Re,ax as He,ay as Y,az as Fe,aA as Ue,g as m,aB as je,aC as Ye,aD as ze,aE as ie,aF as ye,aG as se,aH as Z,aI as we,aJ as _e,Q as Qe,t as v,aK as Ke,aL as ge,S as T,aM as I,aN as Ce,aO as ae,a0 as R,$ as G,aa as Pe,H as le,E as We,W as Xe,b as qe,y as Je,R as Ve,T as Ze,A as ve,o as Ge,B as q,a3 as et,aP as tt,aQ as he,aR as me,aS as be,m as nt}from"./index-CvtbhWKk.js";import{D as rt}from"./DocumentTitle-CAyQkV9I.js";import{f as it}from"./time-BcQrJBX1.js";import{I as fe}from"./IconReload-deI6hza4.js";/**
 * @license @tabler/icons-solidjs v3.19.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var pe=Ee("outline","brand-speedtest","IconBrandSpeedtest",[["path",{d:"M5.636 19.364a9 9 0 1 1 12.728 0"}],["path",{d:"M16 9l-4 4"}]]),st=v('<div class="flex flex-col gap-4"><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><input type=number class="input input-bordered w-full"></div><div><select class="select select-bordered w-full"></select></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><select class="select select-bordered w-full"></select></div><div><input type=number class="input input-bordered w-full"><input type=number class="input input-bordered w-full">'),lt=v('<option class="flex items-center gap-2">'),at=v("<option>");const ct=s=>{const[r]=ee();return e(Qe,{ref:n=>{var l;return(l=s.ref)==null?void 0:l.call(s,n)},get icon(){return e(De,{size:24})},get title(){return r("proxiesSettings")},get children(){var n=st(),l=n.firstChild,d=l.firstChild,u=d.firstChild,x=l.nextSibling,N=x.firstChild,o=x.nextSibling,M=o.firstChild,$=o.nextSibling,w=$.firstChild,P=$.nextSibling,k=P.firstChild,b=k.firstChild,S=P.nextSibling,O=S.firstChild,_=O.firstChild,L=S.nextSibling,F=L.firstChild,z=L.nextSibling,j=z.firstChild,Q=j.nextSibling;return t(l,e(D,{withDivider:!0,get children(){return r("autoCloseConns")}}),d),u.addEventListener("change",a=>Ie(a.target.checked)),t(x,e(D,{withDivider:!0,get children(){return r("urlForLatencyTest")}}),N),N.addEventListener("change",a=>Me(a.target.value)),t(o,e(D,{withDivider:!0,get children(){return[p(()=>r("latencyTestTimeoutDuration"))," (",p(()=>r("ms")),")"]}}),M),M.addEventListener("change",a=>ke(Number(a.target.value))),t($,e(D,{withDivider:!0,get children(){return r("proxiesSorting")}}),w),w.addEventListener("change",a=>Oe(a.target.value)),t(w,e(H,{get each(){return Object.values(Ae)},children:a=>(()=>{var y=lt();return y.value=a,t(y,()=>r(a)),y})()})),t(P,e(D,{withDivider:!0,get children(){return r("hideUnavailableProxies")}}),k),b.addEventListener("change",a=>Be(a.target.checked)),t(S,e(D,{withDivider:!0,get children(){return r("renderInTwoColumns")}}),O),_.addEventListener("change",a=>Re(a.target.checked)),t(L,e(D,{withDivider:!0,get children(){return r("proxiesPreviewType")}}),F),F.addEventListener("change",a=>He(a.target.value)),t(F,e(H,{get each(){return Object.values(Y)},children:a=>(()=>{var y=at();return y.value=a,t(y,()=>r(a)),y})()})),t(z,e(D,{withDivider:!0,get children(){return r("iconHeight")}}),j),j.addEventListener("change",a=>Fe(Number(a.target.value))),t(z,e(D,{withDivider:!0,get children(){return r("iconMarginRight")}}),Q),Q.addEventListener("change",a=>Ue(Number(a.target.value))),m(()=>u.checked=je()),m(()=>N.value=Ye()),m(()=>M.value=ze()),m(()=>w.value=ie()),m(()=>b.checked=ye()),m(()=>_.checked=se()),m(()=>F.value=Z()),m(()=>j.value=we()),m(()=>Q.value=_e()),n}})},xe=s=>{const r=()=>Z()===Y.OFF,n=p(()=>s.proxyNameList.length<=10),l=p(()=>{const u=Z();return u===Y.BAR||u===Y.Auto&&!n()}),d=p(()=>{const u=Z();return u===Y.DOTS||u===Y.Auto&&n()});return e(T,{get when(){return!r()},get children(){return e(Ke,{get children(){return[e(ge,{get when(){return l()},get children(){return e(ot,{get proxyNameList(){return s.proxyNameList},get now(){return s.now}})}}),e(ge,{get when(){return d()},get children(){return e(ht,{get proxyNameList(){return s.proxyNameList},get now(){return s.now}})}})]}})}})};var dt=v('<div class="flex items-center gap-2 py-2"><div class="my-1 flex flex-1 items-center justify-center overflow-hidden rounded-2xl [&amp;>*]:h-2"><div class=bg-success></div><div class=bg-warning></div><div class=bg-error></div><div class=bg-neutral>');const ot=s=>{const{getLatencyByName:r}=ae(),n=p(()=>s.proxyNameList.map(o=>r(o))),l=p(()=>n().length),d=p(()=>n().filter(o=>o>I().NOT_CONNECTED&&o<=I().MEDIUM).length),u=p(()=>n().filter(o=>o>I().MEDIUM&&o<=I().HIGH).length),x=p(()=>n().filter(o=>o>I().HIGH).length),N=p(()=>n().filter(o=>o===I().NOT_CONNECTED).length);return(()=>{var o=dt(),M=o.firstChild,$=M.firstChild,w=$.nextSibling,P=w.nextSibling,k=P.nextSibling;return t(o,e(T,{get when(){return s.now},get children(){return e(Ce,{get proxyName(){return s.now}})}}),null),m(b=>{var S=`${d()*100/l()}%`,O=`${u()*100/l()}%`,_=`${x()*100/l()}%`,L=`${N()*100/l()}%`;return S!==b.e&&((b.e=S)!=null?$.style.setProperty("width",S):$.style.removeProperty("width")),O!==b.t&&((b.t=O)!=null?w.style.setProperty("width",O):w.style.removeProperty("width")),_!==b.a&&((b.a=_)!=null?P.style.setProperty("width",_):P.style.removeProperty("width")),L!==b.o&&((b.o=L)!=null?k.style.setProperty("width",L):k.style.removeProperty("width")),b},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()};var ut=v("<div>"),gt=v('<div class="flex items-center gap-2 py-2"><div class="flex flex-1 flex-wrap items-center gap-1">');const vt=s=>{let r=s.selected?"bg-white border-4 border-success":"bg-success";return typeof s.latency!="number"||s.latency===I().NOT_CONNECTED?r=s.selected?"bg-white border-4 border-neutral":"bg-neutral":s.latency>I().HIGH?r=s.selected?"bg-white border-4 border-error":"bg-error":s.latency>I().MEDIUM&&(r=s.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{var n=ut();return m(l=>{var d=R("h-4 w-4 rounded-full",r),u=s.name;return d!==l.e&&G(n,l.e=d),u!==l.t&&Pe(n,"title",l.t=u),l},{e:void 0,t:void 0}),n})()},ht=s=>{const{getLatencyByName:r}=ae();return(()=>{var n=gt(),l=n.firstChild;return t(l,e(H,{get each(){return s.proxyNameList.map(d=>[d,r(d)])},children:([d,u])=>e(vt,{name:d,latency:u,get selected(){return s.now===d}})})),t(n,e(T,{get when(){return s.now},get children(){return e(Ce,{get proxyName(){return s.now}})}}),null),n})()};var mt=v("<progress class=progress max=100>"),bt=v('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),ft=v('<div class="text-sm text-slate-500">: ');const pt=s=>{const{Download:r=0,Upload:n=0,Total:l=0,Expire:d=0}=s,u=le(l,{units:"iec"}),x=le(r+n,{units:"iec"}),N=We.toFinite(((r+n)/l*100).toFixed(2));return{total:u,used:x,percentage:N,expirePrefix:()=>{const[$]=ee();return $("expire")},expireStr:()=>{const[$]=ee();return d===0?$("noExpire"):Xe(d*1e3).format("YYYY-MM-DD")}}},xt=s=>{if(!s.subscriptionInfo)return;const r=pt(s.subscriptionInfo);return[(()=>{var n=mt();return m(()=>n.value=r.percentage),n})(),(()=>{var n=bt(),l=n.firstChild,d=l.nextSibling,u=d.nextSibling,x=u.nextSibling;return x.nextSibling,t(n,()=>`${r.used}`,l),t(n,()=>`${r.total}`,d),t(n,()=>r.percentage,x),n})(),(()=>{var n=ft(),l=n.firstChild;return t(n,()=>r.expirePrefix(),l),t(n,()=>r.expireStr(),null),n})()]};var $e=v("<div>"),$t=v('<div class="flex h-full flex-col gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><div class=ml-auto></div></div><div class="flex-1 overflow-y-auto">'),yt=v('<button><span></span><div class="badge badge-sm">'),wt=v("<img>"),_t=v("<span class=whitespace-nowrap>&nbsp;::&nbsp;"),Ct=v('<div class=space-y-2><div class="flex items-center justify-between pr-8"><div class="flex items-center"><span></span><div class="badge badge-sm ml-2"></div></div></div><div class="flex flex-wrap items-center justify-between gap-2"><div class="badge badge-primary badge-sm"><span class=font-bold></span></div><div class="badge badge-secondary badge-sm">/s'),Pt=v('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div class="flex items-center gap-2">'),St=v('<div class="text-sm text-slate-500"> :: <!> ');const Dt=()=>{const s=qe();if(!Je())return s("/setup",{replace:!0}),null;let r;const[n]=ee(),{fetchProxies:l,proxies:d,selectProxyInGroup:u,proxyProviders:x,updateProviderByProviderName:N,updateAllProvider:o,proxyGroupLatencyTest:M,proxyProviderLatencyTest:$,proxyGroupLatencyTestingMap:w,proxyProviderLatencyTestingMap:P,isAllProviderUpdating:k,updatingMap:b}=ae(),S=p(()=>d().filter(f=>!f.hidden)),{speedGroupByName:O}=Ve(),[_,L]=Ze(ve({}),{name:"collapsedMap",storage:localStorage}),F=(f,C)=>{L(J=>({...J,[f]:C}))};Ge(l);const z=async(f,C)=>{f.stopPropagation(),M(C)},j=(f,C)=>{f.stopPropagation(),$(C)},Q=(f,C)=>{f.stopPropagation(),N(C)},a=async f=>{f.stopPropagation(),o()},[y,Se]=ve("proxies"),Te=()=>[{type:"proxies",name:n("proxies"),count:S().length},{type:"proxyProviders",name:n("proxyProviders"),count:x().length}];return[e(rt,{get children(){return n("proxies")}}),(()=>{var f=$t(),C=f.firstChild,J=C.firstChild,ce=J.nextSibling,de=C.nextSibling;return t(J,e(H,{get each(){return Te()},children:h=>(()=>{var i=yt(),A=i.firstChild,K=A.nextSibling;return i.$$click=()=>Se(h.type),t(A,()=>h.name),t(K,()=>h.count),m(()=>G(i,R(y()===h.type&&"tab-active","tab-sm sm:tab-md tab gap-2 px-2"))),i})()})),t(C,e(T,{get when(){return y()==="proxyProviders"},get children(){return e(q,{class:"btn btn-circle btn-sm",get disabled(){return k()},onClick:h=>a(h),get icon(){return e(fe,{get class(){return R(k()&&"animate-spin text-success")}})}})}}),ce),t(ce,e(q,{class:"btn-circle btn-primary btn-sm",onClick:()=>r==null?void 0:r.showModal(),get icon(){return e(et,{})}})),t(de,e(T,{get when(){return y()==="proxies"},get children(){var h=$e();return t(h,e(H,{get each(){return S()},children:i=>{const A=p(()=>tt(he(i.all??[],ie()),ye())),K=(()=>{var c=Ct(),E=c.firstChild,B=E.firstChild,W=B.firstChild,V=W.nextSibling,X=E.nextSibling,te=X.firstChild,Ne=te.firstChild,oe=te.nextSibling,Le=oe.firstChild;return t(B,e(T,{get when(){return i.icon},get children(){var g=wt();return m(U=>{var ue=i.icon,ne=`${we()}px`,re=`${_e()}px`;return ue!==U.e&&Pe(g,"src",U.e=ue),ne!==U.t&&((U.t=ne)!=null?g.style.setProperty("height",ne):g.style.removeProperty("height")),re!==U.a&&((U.a=re)!=null?g.style.setProperty("margin-right",re):g.style.removeProperty("margin-right")),U},{e:void 0,t:void 0,a:void 0}),g}}),W),t(W,()=>i.name),t(V,()=>{var g;return(g=i.all)==null?void 0:g.length}),t(E,e(q,{class:"btn-circle btn-sm",get disabled(){return w()[i.name]},onClick:g=>z(g,i.name),get icon(){return e(pe,{get class(){return R(w()[i.name]&&"animate-pulse text-success")}})}}),null),t(Ne,()=>i.type),t(te,e(T,{get when(){var g;return((g=i.now)==null?void 0:g.length)>0},get children(){var g=_t();return g.firstChild,t(g,()=>i.now,null),g}}),null),t(oe,()=>le(O()[i.name]??0).toString(),Le),t(c,e(T,{get when(){return!_()[i.name]},get children(){return e(xe,{get proxyNameList(){return A()},get now(){return i.now}})}}),null),c})();return e(me,{get isOpen(){return _()[i.name]},title:K,onCollapse:c=>F(i.name,c),get children(){return e(H,{get each(){return A()},children:c=>e(be,{proxyName:c,get isSelected(){return i.now===c},onClick:()=>void u(i,c)})})}})}})),m(()=>G(h,R("grid grid-cols-1 place-items-start gap-2",se()?"sm:grid-cols-2":"sm:grid-cols-1"))),h}}),null),t(de,e(T,{get when(){return y()==="proxyProviders"},get children(){var h=$e();return t(h,e(H,{get each(){return x()},children:i=>{const A=p(()=>he(i.proxies.map(c=>c.name)??[],ie())),K=[(()=>{var c=Pt(),E=c.firstChild,B=E.firstChild,W=B.nextSibling,V=E.nextSibling;return t(B,()=>i.name),t(W,()=>i.proxies.length),t(V,e(q,{class:"btn btn-circle btn-sm",get disabled(){return b()[i.name]},onClick:X=>Q(X,i.name),get icon(){return e(fe,{get class(){return R(b()[i.name]&&"animate-spin text-success")}})}}),null),t(V,e(q,{class:"btn btn-circle btn-sm",get disabled(){return P()[i.name]},onClick:X=>j(X,i.name),get icon(){return e(pe,{get class(){return R(P()[i.name]&&"animate-pulse text-success")}})}}),null),c})(),e(xt,{get subscriptionInfo(){return i.subscriptionInfo}}),(()=>{var c=St(),E=c.firstChild,B=E.nextSibling;return B.nextSibling,t(c,()=>i.vehicleType,E),t(c,()=>n("updated"),B),t(c,()=>it(i.updatedAt),null),c})(),e(T,{get when(){return!_()[i.name]},get children(){return e(xe,{get proxyNameList(){return A()}})}})];return e(me,{get isOpen(){return _()[i.name]},title:K,onCollapse:c=>F(i.name,c),get children(){return e(H,{get each(){return A()},children:c=>e(be,{proxyName:c})})}})}})),m(()=>G(h,R("grid grid-cols-1 place-items-start gap-2",se()?"sm:grid-cols-2":"sm:grid-cols-1"))),h}}),null),t(f,e(ct,{ref:h=>r=h}),null),f})()]};nt(["click"]);export{Dt as default};
