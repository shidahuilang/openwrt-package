import{u as z,a as P,b as q,c as H,v as M,o as N,e as u,d as T,i as o,f as h,B as _,I as X,F as G,t as L,z as f,s as b,g as S,h as J,j as C,k as K,l as O,m as Q}from"./index-QV8LhAb2.js";var a=[];for(var y=0;y<256;++y)a.push((y+256).toString(16).slice(1));function W(t,n=0){return(a[t[n+0]]+a[t[n+1]]+a[t[n+2]]+a[t[n+3]]+"-"+a[t[n+4]]+a[t[n+5]]+"-"+a[t[n+6]]+a[t[n+7]]+"-"+a[t[n+8]]+a[t[n+9]]+"-"+a[t[n+10]]+a[t[n+11]]+a[t[n+12]]+a[t[n+13]]+a[t[n+14]]+a[t[n+15]]).toLowerCase()}var m,Y=new Uint8Array(16);function Z(){if(!m&&(m=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!m))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(Y)}var tt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const E={randomUUID:tt};function et(t,n,x){if(E.randomUUID&&!n&&!t)return E.randomUUID();t=t||{};var l=t.random||(t.rng||Z)();return l[6]=l[6]&15|64,l[8]=l[8]&63|128,W(l)}var nt=L('<div class="mx-auto flex max-w-screen-sm flex-col items-center gap-4 py-10"><form class=contents><div class="flex w-full flex-col gap-4"><div class=flex-1><label class=label><span class=label-text></span></label><input name=url type=url class="input input-bordered w-full"placeholder=http://127.0.0.1:9090 list=defaultEndpoints><datalist id=defaultEndpoints><option value=http://127.0.0.1:9090></option></datalist></div><div class=flex-1><label class=label><span class=label-text></span></label><input name=secret type=password class="input input-bordered w-full"placeholder=secret></div></div></form><div class="grid w-full grid-cols-2 gap-4">'),st=L('<div class="badge badge-info flex w-full cursor-pointer items-center justify-between gap-4 py-4"><span class=truncate>');const at=f.object({url:f.string().min(1),secret:f.string()}),lt=()=>{const[t]=z(),n=P(),x=q(),l=s=>{C(s),x("/overview")},$=(s,e)=>O.get(s,{headers:e?{Authorization:`Bearer ${e}`}:{}}).then(({ok:r})=>r).catch(r=>{const{message:i}=r;S.error(i)}),R=async s=>{const e=u().find(r=>r.id===s);e&&await $(e.url,e.secret)&&l(s)},g=async({url:s,secret:e})=>{const r=Q(s);if(!await $(r,e))return;const i=et(),c=u().slice(),d=c.find(v=>v.url===r);if(!d){b([{id:i,url:r,secret:e},...c]),l(i);return}d.secret=e,d.id=i,b(c),l(i)},I=s=>{const{message:e}=s;S.error(e)},{form:w}=H({extend:M({schema:at}),onSubmit:g,onError:I}),k=s=>{J()===s&&C(""),b(u().filter(e=>e.id!==s))};return N(()=>{let s=n.search||window.location.search;if(s){const r=n.hash.match(/\?.*$/);Array.isArray(r)&&r[0]&&(s=r[0].replace("?",""))}const e=new URLSearchParams(s);e.has("hostname")?g({url:`${e.get("http")?"http:":e.get("https")?"https:":window.location.protocol}//${e.get("hostname")}${e.get("port")?`:${e.get("port")}`:""}`,secret:e.get("secret")??""}):u().length===0&&g({url:"http://127.0.0.1:9090",secret:""})}),(()=>{var s=nt(),e=s.firstChild,r=e.firstChild,i=r.firstChild,c=i.firstChild,d=c.firstChild,v=i.nextSibling,D=v.firstChild,j=D.firstChild,A=e.nextSibling;return T(w,e,()=>w),o(d,()=>t("endpointURL")),o(j,()=>t("secret")),o(r,h(_,{type:"submit",class:"btn-primary uppercase",get children(){return t("add")}}),null),o(A,h(G,{get each(){return u()},children:({id:U,url:V})=>(()=>{var p=st(),B=p.firstChild;return p.$$click=()=>R(U),o(B,V),o(p,h(_,{class:"btn-circle btn-ghost btn-xs text-white",onClick:F=>{F.stopPropagation(),k(U)},get children(){return h(X,{})}}),null),p})()})),s})()};K(["click"]);export{lt as default};
