import{k as G,c as t,K as he,i as n,F as R,O as ee,a9 as Pe,aa as Te,ab as Ne,ac as Oe,ad as Ee,S as ve,b as P,d as m,a5 as J,a2 as ze,a3 as Ke,N as pe,q as Ce,ae as te,af as Me,ag as ke,m as Ge,ah as Re,ai as je,aj as Ae,ak as Le,Y as ie,h as B,j as Ve,p as He,a7 as Ue,A as K,g as A,t as L,al as Be,am as qe,M as We,P as X,an as ce,ao as de,ap as Ye,aq as Ze,D as Je,e as Xe}from"./vendor-TCjgV7Sn.js";import{c as Qe,g as et,a as tt,b as nt,d as at,e as rt,f as q,r as st}from"./index-IZ7lrjtp.js";import{u as W,B as T,f as lt,g as ot,h as it,T as ct,i as V,j as $e,k as _e,M as Se,m as ne,n as dt,o as u,p as ue,q as ge,r as me,v as ut,w as gt,x as mt,y as ft}from"./index-k-FO5KmN.js";import{C as Q}from"./ConfigTitle-_jKUZ02Y.js";import{f as bt}from"./global-MCJ9PAgv.js";var ht=m('<form><div class="join flex"><select name=sourceIP class="select join-item select-bordered"><option></option></select><input name=tagName class="input join-item input-bordered min-w-0 flex-1"placeholder=name>'),vt=m("<option class=badge>"),pt=m('<div><div class="flex justify-between py-2"><div class="flex items-center gap-2"><span></span></div><input type=checkbox class=toggle>'),Ct=m("<div>"),$t=m('<div class="flex flex-col gap-4"><div><select class="select select-bordered w-full"></select></div><div><div class="flex flex-col gap-4"><div class="flex flex-col gap-2"></div></div></div><div>'),_t=m("<option>"),St=m('<div class="badge badge-primary w-full items-center justify-between gap-2 py-4"><span class=truncate> (<!>)');const xt=()=>{const s=J.object({tagName:J.string().nonempty(),sourceIP:J.string().nonempty()}),[g]=W(),{form:r,reset:C}=ze({extend:Ke({schema:s}),onSubmit:({tagName:h,sourceIP:y})=>{$e($=>$.some(o=>o.tagName===h||o.sourceIP===y)?$:[...$,{tagName:h,sourceIP:y}]),C()}});return(()=>{var h=ht(),y=h.firstChild,$=y.firstChild;return $.firstChild,$.nextSibling,pe(r,h,()=>r),n($,t(te,{get each(){return Ce.uniq(ne().map(({metadata:{sourceIP:o}})=>o)).sort().filter(o=>!V().some(({sourceIP:i})=>i===o))},children:o=>(()=>{var i=vt();return n(i,o),P(()=>i.value=o()),i})()}),null),n(y,t(T,{type:"submit",class:"join-item",get children(){return g("tag")}}),null),h})()},It=s=>{const[g]=W(),[r,C]=G(null),h=({draggable:o})=>C(o.id),y=({draggable:o,droppable:i})=>{if(o&&i){const _=s.order,f=_.indexOf(o.id),w=_.indexOf(i.id);if(f!==w){const S=_.slice();S.splice(w,0,...S.splice(f,1)),s.onOrderChange(S)}}},$=({key:o})=>{const i=Me(o),[_]=ke();return(()=>{var f=pt(),w=f.firstChild,S=w.firstChild,M=S.firstChild,b=S.nextSibling,F=i.ref;return typeof F=="function"?pe(F,f):i.ref=f,n(S,t(T,Ge({class:"btn-ghost btn-sm cursor-grab",get icon(){return t(Re,{size:24})}},()=>i.dragActivators)),M),n(M,()=>g(o)),b.addEventListener("change",v=>{s.onVisibleChange({...s.visible,[o]:v.target.checked})}),P(v=>{var N=!!i.isActiveDraggable,I=!!_.active.draggable,O=je(i.transform);return N!==v.e&&f.classList.toggle("opacity-25",v.e=N),I!==v.t&&f.classList.toggle("transition-transform",v.t=I),v.a=Ae(f,O,v.a),v},{e:void 0,t:void 0,a:void 0}),P(()=>b.checked=s.visible[o]),f})()};return t(Se,{ref:o=>{var i;return(i=s.ref)==null?void 0:i.call(s,o)},get icon(){return t(he,{size:24})},get title(){return g("connectionsSettings")},get action(){return t(T,{class:"btn-neutral btn-sm",onClick:()=>{s.onOrderChange(lt),s.onVisibleChange(ot)},get children(){return g("reset")}})},get children(){var o=$t(),i=o.firstChild,_=i.firstChild,f=i.nextSibling,w=f.firstChild,S=w.firstChild,M=f.nextSibling;return n(i,t(Q,{withDivider:!0,get children(){return g("tableSize")}}),_),_.addEventListener("change",b=>it(b.target.value)),n(_,t(R,{get each(){return Object.values(ct)},children:b=>(()=>{var F=_t();return F.value=b,n(F,()=>g(b)),F})()})),n(f,t(Q,{withDivider:!0,get children(){return g("tagClientSourceIPWithName")}}),w),n(w,t(xt,{}),S),n(S,t(R,{get each(){return V()},children:({tagName:b,sourceIP:F})=>(()=>{var v=St(),N=v.firstChild,I=N.firstChild,O=I.nextSibling;return O.nextSibling,n(N,b,I),n(N,F,O),n(v,t(T,{class:"btn-circle btn-ghost btn-xs",onClick:()=>$e(j=>j.filter(Y=>Y.tagName!==b)),get icon(){return t(ee,{size:12})}}),null),v})()})),n(M,t(Q,{withDivider:!0,get children(){return g("sort")}}),null),n(M,t(Pe,{onDragStart:h,onDragEnd:y,collisionDetector:Te,get children(){return[t(Ne,{}),t(Oe,{get ids(){return s.order},get children(){return t(R,{get each(){return s.order},children:b=>t($,{key:b})})}}),t(Ee,{get children(){return t(ve,{get when(){return r()},get children(){var b=Ct();return n(b,()=>g(r())),b}})}})]}}),null),P(()=>_.value=_e()),o}})};var yt=m("<pre><code>");const wt=s=>{const[g]=W();return t(Se,{ref:r=>{var C;return(C=s.ref)==null?void 0:C.call(s,r)},get icon(){return t(he,{size:24})},get title(){return g("connectionsDetails")},get children(){return t(ve,{get when(){return s.selectedConnectionID},get children(){var r=yt(),C=r.firstChild;return n(C,()=>JSON.stringify(ne().find(({id:h})=>h===s.selectedConnectionID),null,2)),r}})}})};var Ft=async s=>{typeof s=="string"?await navigator.clipboard.writeText(s):await navigator.clipboard.write(s)},fe=m('<div class="flex h-4 items-center">'),Dt=m('<div class="flex h-full flex-col gap-2"><div class="flex w-full flex-wrap items-center gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><select class="select select-bordered select-primary select-sm w-full max-w-full flex-1 sm:select-md"><option value=""></option></select></div><div class="join flex flex-1 items-center md:flex-1"><input type=search class="input join-item input-primary input-sm min-w-0 flex-1 sm:input-md"></div></div><div class="overflow-x-auto whitespace-nowrap rounded-md bg-base-300"><table><thead class="sticky top-0 z-10 h-8"></thead><tbody>'),Pt=m('<button><span></span><div class="badge badge-sm">'),Tt=m("<option>"),Nt=m("<tr>"),Ot=m("<th class=bg-base-200><div><div>"),Et=m("<button class=cursor-pointer>"),zt=m('<tr class="hover:!bg-primary hover:text-primary-content">'),Kt=m("<td class=py-2>"),Mt=m("<button><div></div><div></div><div>(<!>)");const be=(s,g,r,C)=>{const h=st(s.getValue(g),r);return C({itemRank:h}),h.passed},Lt=()=>{let s,g;const[r]=W(),[C,h]=G(0),{activeConnections:y,closedConnections:$,paused:o,setPaused:i}=dt(),[_,f]=G(""),[w,S]=G(),M=[{header:()=>r("details"),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:u.Details,cell:({row:e})=>(()=>{var c=fe();return n(c,t(T,{class:"btn-circle btn-xs",onClick:()=>{S(e.original.id),g==null||g.showModal()},get icon(){return t(Le,{size:"16"})}})),c})()},{header:()=>r("close"),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:u.Close,cell:({row:e})=>(()=>{var c=fe();return n(c,t(T,{class:"btn-circle btn-xs",onClick:()=>ue(e.original.id),get icon(){return t(ee,{size:"16"})}})),c})()},{header:()=>r("ID"),enableGrouping:!1,accessorKey:u.ID,accessorFn:e=>e.id},{header:()=>r("type"),accessorKey:u.Type,accessorFn:e=>`${e.metadata.type}(${e.metadata.network})`},{header:()=>r("process"),accessorKey:u.Process,accessorFn:e=>e.metadata.process||e.metadata.processPath.replace(/^.*[/\\](.*)$/,"$1")||"-"},{header:()=>r("host"),accessorKey:u.Host,accessorFn:e=>`${e.metadata.host?e.metadata.host:e.metadata.destinationIP}:${e.metadata.destinationPort}`},{header:()=>r("sniffHost"),accessorKey:u.SniffHost,accessorFn:e=>e.metadata.sniffHost||"-"},{header:()=>r("rules"),accessorKey:u.Rule,accessorFn:e=>e.rulePayload?`${e.rule} :: ${e.rulePayload}`:e.rule},{header:()=>r("chains"),accessorKey:u.Chains,accessorFn:e=>e.chains.slice().reverse().join(" :: ")},{header:()=>r("connectTime"),enableGrouping:!1,accessorKey:u.ConnectTime,accessorFn:e=>bt(e.start),sortingFn:(e,c)=>ie(e.original.start).valueOf()-ie(c.original.start).valueOf()},{header:()=>r("dlSpeed"),enableGrouping:!1,accessorKey:u.DlSpeed,accessorFn:e=>`${B(e.downloadSpeed)}/s`,sortingFn:(e,c)=>e.original.downloadSpeed-c.original.downloadSpeed},{header:()=>r("ulSpeed"),enableGrouping:!1,accessorKey:u.ULSpeed,accessorFn:e=>`${B(e.uploadSpeed)}/s`,sortingFn:(e,c)=>e.original.uploadSpeed-c.original.uploadSpeed},{header:()=>r("dl"),enableGrouping:!1,accessorKey:u.Download,accessorFn:e=>B(e.download),sortingFn:(e,c)=>e.original.download-c.original.download},{header:()=>r("ul"),enableGrouping:!1,accessorKey:u.Upload,accessorFn:e=>B(e.upload),sortingFn:(e,c)=>e.original.upload-c.original.upload},{header:()=>r("sourceIP"),accessorKey:u.SourceIP,accessorFn:e=>{const c=V().find(H=>H.sourceIP===e.metadata.sourceIP);return c?c.tagName:e.metadata.sourceIP}},{header:()=>r("sourcePort"),accessorKey:u.SourcePort,accessorFn:e=>e.metadata.sourcePort},{header:()=>r("destination"),accessorKey:u.Destination,accessorFn:e=>e.metadata.remoteDestination||e.metadata.destinationIP||e.metadata.host},{header:()=>r("inboundUser"),accessorKey:u.InboundUser,accessorFn:e=>e.metadata.inboundUser||e.metadata.inboundName||e.metadata.inboundPort}],[b,F]=G([]),[v,N]=Ve(G([{id:u.ConnectTime,desc:!0}]),{name:"connectionsTableSorting",storage:localStorage}),I=Qe({filterFns:{fuzzy:be},state:{get columnOrder(){return ge()},get grouping(){return b()},get sorting(){return v()},get columnVisibility(){return me()},get globalFilter(){return _()}},get data(){return C()===0?y():$()},sortDescFirst:!0,enableHiding:!0,columns:M,onGlobalFilterChange:f,globalFilterFn:be,onGroupingChange:F,onSortingChange:N,getFilteredRowModel:et(),getSortedRowModel:tt(),getExpandedRowModel:nt(),getGroupedRowModel:at(),getCoreRowModel:rt()}),O=I.getFlatHeaders().find(({id:e})=>e===u.SourceIP),[j,Y]=G("");He(Ue(j,()=>{const e=V().find(c=>c.sourceIP===j());O==null||O.column.setFilterValue(e?e.tagName:j())}));const xe=K(()=>[{type:0,name:r("active"),count:y().length},{type:1,name:r("closed"),count:$().length}]);return(()=>{var e=Dt(),c=e.firstChild,H=c.firstChild,ae=H.firstChild,Z=ae.nextSibling,Ie=Z.firstChild,U=H.nextSibling,re=U.firstChild,ye=c.nextSibling,se=ye.firstChild,le=se.firstChild,we=le.nextSibling;return n(ae,t(te,{get each(){return xe()},children:a=>(()=>{var d=Pt(),l=d.firstChild,E=l.nextSibling;return d.$$click=()=>h(a().type),n(l,()=>a().name),n(E,()=>a().count),P(()=>A(d,L(C()===a().type&&"tab-active","tab tab-sm gap-2 sm:tab-md"))),d})()})),Z.addEventListener("change",a=>Y(a.target.value)),n(Ie,()=>r("all")),n(Z,t(te,{get each(){return Ce.uniq(ne().map(({metadata:{sourceIP:a}})=>{const d=V().find(l=>l.sourceIP===a);return d?d.tagName:a})).sort()},children:a=>(()=>{var d=Tt();return n(d,a),P(()=>d.value=a()),d})()}),null),re.$$input=a=>f(a.target.value),n(U,t(T,{class:"join-item btn-sm sm:btn-md",onClick:()=>i(a=>!a),get icon(){return K(()=>!!o())()?t(Be,{}):t(qe,{})}}),null),n(U,t(T,{class:"join-item btn-sm sm:btn-md",onClick:()=>{I.getState().globalFilter?I.getFilteredRowModel().rows.forEach(({id:a})=>ue(a)):ut()},get icon(){return t(ee,{})}}),null),n(U,t(T,{class:"btn join-item btn-sm sm:btn-md",onClick:()=>s==null?void 0:s.showModal(),get icon(){return t(We,{})}}),null),n(le,t(R,{get each(){return I.getHeaderGroups()},children:a=>(()=>{var d=Nt();return n(d,t(R,{get each(){return a.headers},children:l=>(()=>{var E=Ot(),z=E.firstChild,p=z.firstChild;return n(z,(()=>{var x=K(()=>!!l.column.getCanGroup());return()=>x()?(()=>{var D=Et();return X(D,"click",l.column.getToggleGroupingHandler(),!0),n(D,(()=>{var k=K(()=>!!l.column.getIsGrouped());return()=>k()?t(ce,{size:18}):t(de,{size:18})})()),D})():null})(),p),X(p,"click",l.column.getToggleSortingHandler(),!0),n(p,()=>q(l.column.columnDef.header,l.getContext())),n(z,()=>({asc:t(Ye,{}),desc:t(Ze,{})})[l.column.getIsSorted()]??null,null),P(x=>{var D=L("flex items-center gap-2"),k=L(l.column.getCanSort()&&"cursor-pointer select-none","flex-1");return D!==x.e&&A(z,x.e=D),k!==x.t&&A(p,x.t=k),x},{e:void 0,t:void 0}),E})()})),d})()})),n(we,t(R,{get each(){return I.getRowModel().rows},children:a=>(()=>{var d=zt();return n(d,t(R,{get each(){return a.getVisibleCells()},children:l=>(()=>{var E=Kt();return E.$$contextmenu=z=>{z.preventDefault();const p=l.renderValue();p&&Ft(p).catch(()=>{})},n(E,(()=>{var z=K(()=>!!l.getIsGrouped());return()=>z()?(()=>{var p=Mt(),x=p.firstChild,D=x.nextSibling,k=D.nextSibling,Fe=k.firstChild,oe=Fe.nextSibling;return oe.nextSibling,X(p,"click",a.getToggleExpandedHandler(),!0),n(x,(()=>{var De=K(()=>!!a.getIsExpanded());return()=>De()?t(ce,{size:18}):t(de,{size:18})})()),n(D,()=>q(l.column.columnDef.cell,l.getContext())),n(k,()=>a.subRows.length,oe),P(()=>A(p,L(a.getCanExpand()?"cursor-pointer":"cursor-normal","flex items-center gap-2"))),p})():(()=>{var p=K(()=>!!l.getIsAggregated());return()=>p()?q(l.column.columnDef.aggregatedCell??l.column.columnDef.cell,l.getContext()):(()=>{var x=K(()=>!!l.getIsPlaceholder());return()=>x()?null:q(l.column.columnDef.cell,l.getContext())})()})()})()),E})()})),d})()})),n(e,t(It,{ref:a=>s=a,get order(){return ge()},get visible(){return me()},onOrderChange:a=>gt(a),onVisibleChange:a=>mt({...a})}),null),n(e,t(wt,{ref:a=>g=a,get selectedConnectionID(){return w()}}),null),P(a=>{var d=r("search"),l=L(ft(_e()),"table table-zebra relative rounded-none");return d!==a.e&&Je(re,"placeholder",a.e=d),l!==a.t&&A(se,a.t=l),a},{e:void 0,t:void 0}),e})()};Xe(["input","click","contextmenu"]);export{Lt as default};
